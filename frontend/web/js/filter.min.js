const CURRENT_API="https://www.cbr-xml-daily.ru/daily_json.js";let CURRENT_VALUE=null;const xhr=new XMLHttpRequest;if(xhr.open("GET","https://www.cbr-xml-daily.ru/daily_json.js",!1),xhr.send(),200!=xhr.status)console.log("Ошибка",xhr.statusText);else{let e=JSON.parse(xhr.responseText);CURRENT_VALUE=Math.ceil(e.Valute.USD.Previous)}class Tesla{constructor(e,t,o,r,l){this.price=e,this.range=t,this.speed=o,this.mph=r,this.title=l}}class ModelS extends Tesla{constructor(...e){super(...e),this.title="Model S"}}class ModelY extends Tesla{constructor(...e){super(...e),this.title="Model Y"}}class Model3 extends Tesla{constructor(...e){super(...e),this.title="Model 3"}}class ModelX extends Tesla{constructor(...e){super(...e),this.title="Model X"}}const MODEL_S=new ModelS,MODEL_X=new ModelX,MODEL_Y=new ModelY,MODEL_3=new Model3;let choosedModel,currentInfo,CURRENT,typeWheelsOne,typeWheelsTwo,priceOutput,map={"model-s":MODEL_S,"model-x":MODEL_X,"model-y":MODEL_Y,"model-3":MODEL_3},choosedColor={},choosedWheel={},choosedInterior={},choosedControl={},featureCarColor=document.querySelector(".featureCar__item.color span"),featureCarInterior=document.querySelector(".featureCar__item.interior span"),featureCarWheel=document.querySelector(".featureCar__item.wheels span"),featureCarMod=document.querySelector(".featureCar__item.mod span"),tabPricesRuble=document.querySelector(".tabPrices__currency.ruble span"),tabPricesUsd=document.querySelector(".tabPrices__currency.usd span");const inputsWidthModels=[...document.querySelectorAll(".prices__input")],detailInputs=[...document.querySelectorAll(".filterCar__input")];function filterWheelsArt(){let e=document.querySelectorAll(".filterCar__look.wheels .filterCar__item");[...e].forEach(e=>{e.style.display=e.querySelector(".filterCar__input").getAttribute("data-mod").split(",").includes(currentInfo.getAttribute("data-mod"))?"block":"none"});if(![...e].filter(e=>e.querySelector(".filterCar__input").getAttribute("data-mod").split(",").includes(currentInfo.getAttribute("data-mod"))&&e.querySelector(".filterCar__input").checked).length)return void([...e].filter(e=>"block"==e.style.display)[0].querySelector(".filterCar__input").checked=!0)}function detectChoosedModel(){choosedModel=inputsWidthModels.filter(e=>e.checked)[0].value,currentInfo=inputsWidthModels.filter(e=>e.checked)[0],CURRENT=map[choosedModel],inputsWidthModels.forEach(e=>{e.addEventListener("change",()=>{choosedModel=e.value,currentInfo=e,CURRENT=map[choosedModel],filterWheelsArt(),detectDetail(),pasteInfoToBlocks(),loadSlider(),personModelInfo()})})}function detectDetail(){let e=document.querySelector(".outputPrice__value");detailInputs.filter(e=>e.checked).forEach(t=>{switch(t.name){case"price":featureCarMod.textContent=t.getAttribute("data-mod"),typeWheelsOne=t.getAttribute("data-type-one"),typeWheelsTwo=t.getAttribute("data-type-two"),priceOutput=parseInt(t.nextElementSibling.querySelector(".prices__count").innerText.replace(/[^\d]/g,"")),e.setAttribute("data-output-price",priceOutput);case"paint":choosedColor.value=t.getAttribute("data-state"),choosedColor.descr=t.getAttribute("data-descr"),choosedColor.price=t.getAttribute("data-paint-price"),featureCarColor.textContent=t.getAttribute("data-descr"),choosedColor.folder=choosedColor.value;case"wheels":choosedWheel.value=t.getAttribute("data-state"),choosedWheel.descr=t.getAttribute("data-descr"),choosedWheel.price=t.getAttribute("data-wheels-price"),featureCarWheel.textContent=t.getAttribute("data-descr"),choosedWheel.folder="tempest"==choosedWheel.value?`type${typeWheelsOne}`:`type${typeWheelsTwo}`;case"Interior":choosedInterior.value=t.getAttribute("data-state"),choosedInterior.descr=t.getAttribute("data-descr"),featureCarInterior.textContent=t.getAttribute("data-descr"),choosedInterior.price=t.getAttribute("data-interior-price"),choosedInterior.folder=choosedInterior.value;case"control":choosedControl.value=t.getAttribute("data-state"),choosedControl.descr=t.getAttribute("data-descr"),choosedControl.folder="yoke"==choosedControl.value?"plaid"==document.querySelector(".prices__input.filterCar__input:checked").getAttribute("data-modification")?"type4":"type2":"plaid"==document.querySelector(".prices__input.filterCar__input:checked").getAttribute("data-modification")?"type3":"type1"}})}function pasteInfoToBlocks(){var e,t;function o(e,t){e.querySelector(".filterCar__mobile img").src=t}function r(e,t,o){o=o&&0<o?`$${o}`:"",e.querySelector(".filterCar__value").innerText=`${t} ${o}`}function l(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}let s=document.querySelector(".filterCar__look.paint"),i=document.querySelector(".filterCar__look.Interior"),d=document.querySelector(".filterCar__look.wheels"),a=document.querySelector(".filterCar__look.control"),c=document.querySelector(".outputPrice__value"),n=+choosedColor.price+ +choosedInterior.price+ +choosedWheel.price,u;o(s,`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/2.jpg`),o(i,`img/filter/${choosedModel}/handlebar/${choosedControl.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/1.jpg`),o(d,`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/4.jpg`),e=c,t=n,u=+e.getAttribute("data-output-price"),e.textContent=`${l((u+t)*CURRENT_VALUE)} ₽`,tabPricesUsd.textContent=`${l(u+t)}`,tabPricesRuble.textContent=`${l((u+t)*CURRENT_VALUE)}`,r(s,choosedColor.descr,choosedColor.price),r(i,choosedInterior.descr,choosedInterior.price),r(d,choosedWheel.descr,choosedWheel.price),a&&r(a,choosedControl.descr,!1)}function loadSlider(){let e=document.querySelector(".swiper-wrapper.swiperConfig__inner"),t=e.querySelectorAll(".swiper-slide");t.forEach(e=>{let t=e.querySelector("img"),o=e.getAttribute("data-swiper-slide-index");switch(+o){case 0:return void(t.src=`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/1.jpg`);case 1:return void(t.src=`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/2.jpg`);case 2:return void(t.src=`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/3.jpg`);case 3:return void(t.src=`img/filter/${choosedModel}/wheels/${choosedWheel.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/4.jpg`);case 4:return void(t.src=`img/filter/${choosedModel}/handlebar/${choosedControl.folder}/Interior/${choosedInterior.folder}/${choosedColor.folder}/1.jpg`)}})}function personModelInfo(){let e=document.querySelector(".detailsCar__feature"),t=e.querySelector(".speed"),o=e.querySelector(".range"),r=e.querySelector(".mph"),l=document.querySelector(".detailsCar__title");t.innerText=currentInfo.getAttribute("data-mph"),o.innerText=currentInfo.getAttribute("data-mi"),r.innerText=currentInfo.getAttribute("data-sec"),l.innerText=CURRENT.title}detectChoosedModel(),detailInputs.forEach(e=>{e.addEventListener("input",()=>{detectDetail(),loadSlider(),pasteInfoToBlocks()})});const swiperConfig=document.querySelectorAll(".swiperConfig");swiperConfig.forEach(e=>{let t=new Swiper(e,{spaceBetween:20,slidesPerView:1,mousewheel:!0,keyboard:!0,effect:"fade",loop:!0,on:{init(){detectChoosedModel(),detectDetail(),personModelInfo(),pasteInfoToBlocks(),loadSlider()}},navigation:{nextEl:".swiperConfig__prev",prevEl:".swiperConfig__next"},breakpoints:{320:{slidesPerView:"auto",spaceBetween:0,enabled:!1},769:{slidesPerView:1}}}),o=new IntersectionObserver((e,o)=>{e.forEach(e=>{e.isIntersecting&&("start"===e.target.getAttribute("data-observer")?t.slideTo(5):"end"===e.target.getAttribute("data-observer")&&t.slideTo(1),o.unobserve(e.target))})},{rootMargin:"10px 0px 10px 0px"});if(window.matchMedia("(min-width: 1100px)").matches){let r=document.querySelector(".detailsCar__info");r.addEventListener("scroll",()=>{setTimeout(()=>{document.querySelectorAll("[data-observer]").forEach(e=>o.observe(e))},1e3)})}});const modalCars=document.querySelectorAll(".modalCars");modalCars.forEach(e=>{new Swiper(e,{spaceBetween:20,slidesPerView:"auto",centeredSlides:!0,mousewheel:!0,keyboard:!0,speed:1e3,navigation:{nextEl:".modalCars__next",prevEl:".modalCars__prev"},pagination:{el:".modalCars__dots",clickable:!0}})});const popupCars=document.querySelector(".modal-cars"),overlay=document.querySelector(".overlay"),modalCarsClose=document.querySelectorAll(".modalCars__close"),openModalGallery=document.querySelectorAll("[data-modal-gallery]");function siblings(e){let t=[],o=e;for(;o.previousSibling;)1==(o=o.previousSibling).nodeType&&t.push(o);for(o=e;o.nextSibling;)1==(o=o.nextSibling).nodeType&&t.push(o);return t}openModalGallery?.forEach(e=>{e.addEventListener("click",()=>{overlay.style.display="block",popupCars?.classList.add("active")})}),modalCarsClose?.forEach(e=>{e.addEventListener("click",()=>{popupCars?.classList.remove("active"),overlay.style.display="none"})}),overlay?.addEventListener("click",function(){popupCars?.classList.remove("active"),this.style.display="none"});const tabs=document.querySelectorAll(".tabPrices__tab"),tabContentItem=document.querySelectorAll(".tabPrices__item");function arr(e){for(let t=0;t<e.length;t++)e[t].classList.remove("active")}tabs.forEach((e,t)=>{e.addEventListener("click",function(){this.classList.add("active"),tabContentItem[t].classList.add("active");let o=siblings(e),r=siblings(tabContentItem[t]);arr(o),arr(r)})});